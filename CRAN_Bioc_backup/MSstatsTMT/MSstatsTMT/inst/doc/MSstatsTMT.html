<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ting Huang (thuang0703@gmail.com), Meena Choi (mnchoi67@gmail.com), Mateusz Staniak (mtst@mstaniak.pl), Sicheng Hao (hao.sic@husky.neu.edu), Olga Vitek(o.vitek@northeastern.edu)" />

<meta name="date" content="2023-10-24" />

<title>MSstatsTMT : A package for protein significance analysis in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MSstatsTMT : A package for protein significance analysis in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling</h1>
<h4 class="author">Ting Huang (<a href="mailto:thuang0703@gmail.com" class="email">thuang0703@gmail.com</a>), Meena Choi (<a href="mailto:mnchoi67@gmail.com" class="email">mnchoi67@gmail.com</a>), Mateusz Staniak (<a href="mailto:mtst@mstaniak.pl" class="email">mtst@mstaniak.pl</a>), Sicheng Hao (<a href="mailto:hao.sic@husky.neu.edu" class="email">hao.sic@husky.neu.edu</a>), Olga Vitek(<a href="mailto:o.vitek@northeastern.edu" class="email">o.vitek@northeastern.edu</a>)</h4>
<h4 class="date">2023-10-24</h4>



<div id="load-msstatstmt" class="section level2">
<h2>0. Load MSstatsTMT</h2>
<p>Load MSstatsTMT first. Then you are ready to start MSstatsTMT</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># ## Install MSstatsTMT package from Bioconductor</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#   install.packages(&quot;BiocManager&quot;)</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># </span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co"># BiocManager::install(&quot;MSstatsTMT&quot;)</span></span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(MSstatsTMT)</span></code></pre></div>
<p>This vignette summarizes the introduction and various options of all functionalities in MSstatsTMT.</p>
<ul>
<li>A set of tools for detecting differentially abundant peptides and proteins in shotgun mass spectrometry-based proteomic experiments with tandem mass tag (TMT) labeling.</li>
<li>The types of experiment that MSstatsTMT supports for metabolic labeling or iTRAQ experiments. LC-MS, SRM, DIA(SWATH) with label-free or labeled synthetic peptides can be analyzed with other R package, MSstats.</li>
</ul>
<p>MSstatsTMT includes the following three steps for statistical testing:</p>
<ol style="list-style-type: decimal">
<li>Converters for different peptide quantification tools to get the input with required format: <code>PDtoMSstatsTMTFormat</code>, <code>MaxQtoMSstatsTMTFormat</code>, <code>SpectroMinetoMSstatsTMTFormat</code>, <code>OpenMStoMSstatsTMTFormat</code> and <code>PhilosophertoMSstatsTMTFormat</code>.</li>
<li>Protein summarization based on peptide quantification data: <code>proteinSummarization</code></li>
<li>Group comparison on protein quantification data: <code>groupComparisonTMT</code></li>
</ol>
</div>
<div id="converters-for-different-peptide-quantification-tools" class="section level2">
<h2>1. Converters for different peptide quantification tools</h2>
<p><code>MSstatsTMT</code> performs statistical analysis steps, that follow peptide identification and quantitation. Therefore, input to MSstatsTMT is the output of other software tools (such as <code>Proteome Discoverer</code>, <code>MaxQuant</code> and so on) that read raw spectral files , identify and quantify peptide ions. The preferred structure of data for use in MSstatsTMT is a .csv file in a <em>long</em> format with at least 9 columns representing the following variables: <strong>ProteinName</strong>, <strong>PeptideSequence</strong>, <strong>Charge</strong>, <strong>PSM</strong>, <strong>Channel</strong>, <strong>Condition</strong>, <strong>BioReplicate</strong>, <strong>Mixture</strong>, <strong>Intensity</strong>. The variable names are fixed, but are case-insensitive.</p>
<pre><code>#&gt;   ProteinName     PeptideSequence Charge                   PSM  Mixture
#&gt; 1      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1
#&gt; 2      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1
#&gt; 3      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1
#&gt; 4      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1
#&gt; 5      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1
#&gt; 6      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1
#&gt;   TechRepMixture                                         Run Channel
#&gt; 1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw     126
#&gt; 2              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C
#&gt; 3              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127N
#&gt; 4              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    128C
#&gt; 5              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    128N
#&gt; 6              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    129C
#&gt;   BioReplicate Condition Intensity
#&gt; 1         Norm      Norm  23398.14
#&gt; 2        0.125     0.125  22387.63
#&gt; 3        0.667     0.667  17754.91
#&gt; 4            1         1  19640.59
#&gt; 5          0.5       0.5  20048.57
#&gt; 6          0.5       0.5  19188.13</code></pre>
<div id="pdtomsstatstmtformat" class="section level3">
<h3>PDtoMSstatsTMTFormat()</h3>
<p>Preprocess PSM data from Proteome Discoverer and convert into the required input format for MSstatsTMT.</p>
<div id="arguments" class="section level4">
<h4>Arguments</h4>
<ul>
<li><code>input</code> : data name of Proteome discover PSM output. Read PSM sheet.</li>
<li><code>annotation</code> : data frame which contains column <code>Run</code>, <code>Fraction</code>, <code>TechRepMixture</code>, <code>Channel</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Mixture</code>.</li>
<li><code>which.proteinid</code> : Use <code>Protein.Accessions</code>(default) column for protein name. <code>Master.Protein.Accessions</code> can be used instead.</li>
<li><code>useNumProteinsColumn</code> : TURE(default) remove shared peptides by information of # Proteins column in PSM sheet.</li>
<li><code>useUniquePeptide</code> : TRUE(default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li><code>rmPSM_withfewMea_withinRun</code> : only for rmPSM_withMissing_withinRun = FALSE. TRUE(default) will remove the features that have 1 or 2 measurements within each Run.</li>
<li><code>removeProtein_with1Peptide</code> : TRUE will remove the proteins which have only 1 peptide and charge. Default is FALSE.</li>
<li><code>summaryforMultipleRows</code> : sum(default) or max - when there are multiple measurements for certain PSM in certain run, select the PSM with the largest summation or maximal value.</li>
</ul>
</div>
<div id="example" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># read in PD PSM sheet</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co"># raw.pd &lt;- read.delim(&quot;161117_SILAC_HeLa_UPS1_TMT10_5Mixtures_3TechRep_UPSdB_Multiconsensus_PD22_Intensity_PSMs.txt&quot;)</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">head</span>(raw.pd)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt;    Checked Confidence Identifying.Node PSM.Ambiguity</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; 1:   FALSE       High      Mascot (O4)   Unambiguous</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; 2:   FALSE       High      Mascot (K2)   Unambiguous</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; 3:   FALSE       High      Mascot (K2)   Unambiguous</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; 4:   FALSE       High      Mascot (F2)      Selected</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; 5:   FALSE       High      Mascot (K2)   Unambiguous</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; 6:   FALSE       High      Mascot (K2)   Unambiguous</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt;                        Annotated.Sequence</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; 1: [K].gFQQILAGEYDHLPEQAFYMVGPIEEAVAk.[A]</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt; 2:          [R].qYPWGVAEVENGEHcDFTILr.[N]</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; 3:              [R].dkPSVEPVEEYDYEDLk.[E]</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; 4:                      [R].hEHQVMLmr.[Q]</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt; 5:       [R].dNLTLWTADNAGEEGGEAPQEPQS.[-]</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt; 6:         [R].aLVAIGTHDLDTLSGPFTYTAk.[R]</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt;                                                      Modifications Marked.as</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt; 1:                                 N-Term(TMT6plex); K30(TMT6plex)        NA</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt; 2: N-Term(TMT6plex); C15(Carbamidomethyl); R21(Label:13C(6)15N(4))        NA</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt; 3:                         N-Term(TMT6plex); K2(Label); K17(Label)        NA</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt; 4:         N-Term(TMT6plex); M8(Oxidation); R9(Label:13C(6)15N(4))        NA</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt; 5:                                                N-Term(TMT6plex)        NA</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">#&gt; 6:                                    N-Term(TMT6plex); K22(Label)        NA</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">#&gt;    X..Protein.Groups X..Proteins Master.Protein.Accessions</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">#&gt; 1:                 1           1                    P06576</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">#&gt; 2:                 1           1                    Q16181</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co">#&gt; 3:                 1           1                    Q9Y450</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="co">#&gt; 4:                 1           1                    Q15233</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">#&gt; 5:                 1           1                    P31947</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="co">#&gt; 6:                 1           1                    Q9NSD9</span></span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="co">#&gt;                                                            Master.Protein.Descriptions</span></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="co">#&gt; 1:         ATP synthase subunit beta, mitochondrial OS=Homo sapiens GN=ATP5B PE=1 SV=3</span></span>
<span id="cb3-34"><a href="#cb3-34"></a><span class="co">#&gt; 2:                                         Septin-7 OS=Homo sapiens GN=SEPT7 PE=1 SV=2</span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="co">#&gt; 3:                                HBS1-like protein OS=Homo sapiens GN=HBS1L PE=1 SV=1</span></span>
<span id="cb3-36"><a href="#cb3-36"></a><span class="co">#&gt; 4: Non-POU domain-containing octamer-binding protein OS=Homo sapiens GN=NONO PE=1 SV=4</span></span>
<span id="cb3-37"><a href="#cb3-37"></a><span class="co">#&gt; 5:                               14-3-3 protein sigma OS=Homo sapiens GN=SFN PE=1 SV=1</span></span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="co">#&gt; 6:          Phenylalanine--tRNA ligase beta subunit OS=Homo sapiens GN=FARSB PE=1 SV=3</span></span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="co">#&gt;    Protein.Accessions</span></span>
<span id="cb3-40"><a href="#cb3-40"></a><span class="co">#&gt; 1:             P06576</span></span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="co">#&gt; 2:             Q16181</span></span>
<span id="cb3-42"><a href="#cb3-42"></a><span class="co">#&gt; 3:             Q9Y450</span></span>
<span id="cb3-43"><a href="#cb3-43"></a><span class="co">#&gt; 4:             Q15233</span></span>
<span id="cb3-44"><a href="#cb3-44"></a><span class="co">#&gt; 5:             P31947</span></span>
<span id="cb3-45"><a href="#cb3-45"></a><span class="co">#&gt; 6:             Q9NSD9</span></span>
<span id="cb3-46"><a href="#cb3-46"></a><span class="co">#&gt;                                                                   Protein.Descriptions</span></span>
<span id="cb3-47"><a href="#cb3-47"></a><span class="co">#&gt; 1:         ATP synthase subunit beta, mitochondrial OS=Homo sapiens GN=ATP5B PE=1 SV=3</span></span>
<span id="cb3-48"><a href="#cb3-48"></a><span class="co">#&gt; 2:                                         Septin-7 OS=Homo sapiens GN=SEPT7 PE=1 SV=2</span></span>
<span id="cb3-49"><a href="#cb3-49"></a><span class="co">#&gt; 3:                                HBS1-like protein OS=Homo sapiens GN=HBS1L PE=1 SV=1</span></span>
<span id="cb3-50"><a href="#cb3-50"></a><span class="co">#&gt; 4: Non-POU domain-containing octamer-binding protein OS=Homo sapiens GN=NONO PE=1 SV=4</span></span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="co">#&gt; 5:                               14-3-3 protein sigma OS=Homo sapiens GN=SFN PE=1 SV=1</span></span>
<span id="cb3-52"><a href="#cb3-52"></a><span class="co">#&gt; 6:          Phenylalanine--tRNA ligase beta subunit OS=Homo sapiens GN=FARSB PE=1 SV=3</span></span>
<span id="cb3-53"><a href="#cb3-53"></a><span class="co">#&gt;    X..Missed.Cleavages Charge DeltaScore DeltaCn Rank Search.Engine.Rank</span></span>
<span id="cb3-54"><a href="#cb3-54"></a><span class="co">#&gt; 1:                   0      3     1.0000       0    1                  1</span></span>
<span id="cb3-55"><a href="#cb3-55"></a><span class="co">#&gt; 2:                   0      3     1.0000       0    1                  1</span></span>
<span id="cb3-56"><a href="#cb3-56"></a><span class="co">#&gt; 3:                   1      3     0.9730       0    1                  1</span></span>
<span id="cb3-57"><a href="#cb3-57"></a><span class="co">#&gt; 4:                   0      4     0.5250       0    1                  1</span></span>
<span id="cb3-58"><a href="#cb3-58"></a><span class="co">#&gt; 5:                   0      3     1.0000       0    1                  1</span></span>
<span id="cb3-59"><a href="#cb3-59"></a><span class="co">#&gt; 6:                   0      3     0.9783       0    1                  1</span></span>
<span id="cb3-60"><a href="#cb3-60"></a><span class="co">#&gt;     m.z..Da. MH...Da. Theo..MH...Da. DeltaM..ppm. Deltam.z..Da. Activation.Type</span></span>
<span id="cb3-61"><a href="#cb3-61"></a><span class="co">#&gt; 1: 1270.3249 3808.960       3808.966        -1.51      -0.00192             CID</span></span>
<span id="cb3-62"><a href="#cb3-62"></a><span class="co">#&gt; 2:  920.4493 2759.333       2759.332         0.31       0.00028             CID</span></span>
<span id="cb3-63"><a href="#cb3-63"></a><span class="co">#&gt; 3:  920.1605 2758.467       2758.461         2.08       0.00192             CID</span></span>
<span id="cb3-64"><a href="#cb3-64"></a><span class="co">#&gt; 4:  359.6898 1435.737       1435.738        -0.04      -0.00002             CID</span></span>
<span id="cb3-65"><a href="#cb3-65"></a><span class="co">#&gt; 5:  920.0943 2758.268       2758.264         1.53       0.00141             CID</span></span>
<span id="cb3-66"><a href="#cb3-66"></a><span class="co">#&gt; 6:  919.8502 2757.536       2757.532         1.48       0.00136             CID</span></span>
<span id="cb3-67"><a href="#cb3-67"></a><span class="co">#&gt;    MS.Order Isolation.Interference.... Average.Reporter.S.N</span></span>
<span id="cb3-68"><a href="#cb3-68"></a><span class="co">#&gt; 1:      MS2                  47.955590                  8.7</span></span>
<span id="cb3-69"><a href="#cb3-69"></a><span class="co">#&gt; 2:      MS2                   9.377507                  8.1</span></span>
<span id="cb3-70"><a href="#cb3-70"></a><span class="co">#&gt; 3:      MS2                  38.317050                 17.8</span></span>
<span id="cb3-71"><a href="#cb3-71"></a><span class="co">#&gt; 4:      MS2                  21.390040                 36.5</span></span>
<span id="cb3-72"><a href="#cb3-72"></a><span class="co">#&gt; 5:      MS2                   0.000000                 16.7</span></span>
<span id="cb3-73"><a href="#cb3-73"></a><span class="co">#&gt; 6:      MS2                  30.619960                 26.7</span></span>
<span id="cb3-74"><a href="#cb3-74"></a><span class="co">#&gt;    Ion.Inject.Time..ms. RT..min. First.Scan</span></span>
<span id="cb3-75"><a href="#cb3-75"></a><span class="co">#&gt; 1:               50.000 212.2487     112815</span></span>
<span id="cb3-76"><a href="#cb3-76"></a><span class="co">#&gt; 2:                3.242 164.7507      87392</span></span>
<span id="cb3-77"><a href="#cb3-77"></a><span class="co">#&gt; 3:               13.596 143.4534      74786</span></span>
<span id="cb3-78"><a href="#cb3-78"></a><span class="co">#&gt; 4:               50.000  21.6426       6458</span></span>
<span id="cb3-79"><a href="#cb3-79"></a><span class="co">#&gt; 5:                6.723 174.1863      92950</span></span>
<span id="cb3-80"><a href="#cb3-80"></a><span class="co">#&gt; 6:                8.958 176.4863      94294</span></span>
<span id="cb3-81"><a href="#cb3-81"></a><span class="co">#&gt;                                   Spectrum.File File.ID Abundance..126</span></span>
<span id="cb3-82"><a href="#cb3-82"></a><span class="co">#&gt; 1: 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_03.raw      F1       2548.326</span></span>
<span id="cb3-83"><a href="#cb3-83"></a><span class="co">#&gt; 2: 161117_SILAC_HeLa_UPS1_TMT10_Mixture3_03.raw      F5      22861.765</span></span>
<span id="cb3-84"><a href="#cb3-84"></a><span class="co">#&gt; 3: 161117_SILAC_HeLa_UPS1_TMT10_Mixture3_03.raw      F5      25504.083</span></span>
<span id="cb3-85"><a href="#cb3-85"></a><span class="co">#&gt; 4: 161117_SILAC_HeLa_UPS1_TMT10_Mixture4_02.raw     F10      13493.228</span></span>
<span id="cb3-86"><a href="#cb3-86"></a><span class="co">#&gt; 5: 161117_SILAC_HeLa_UPS1_TMT10_Mixture3_03.raw      F5      64582.786</span></span>
<span id="cb3-87"><a href="#cb3-87"></a><span class="co">#&gt; 6: 161117_SILAC_HeLa_UPS1_TMT10_Mixture3_03.raw      F5      35404.709</span></span>
<span id="cb3-88"><a href="#cb3-88"></a><span class="co">#&gt;    Abundance..127N Abundance..127C Abundance..128N Abundance..128C</span></span>
<span id="cb3-89"><a href="#cb3-89"></a><span class="co">#&gt; 1:        3231.929        2760.839        4111.639        3127.254</span></span>
<span id="cb3-90"><a href="#cb3-90"></a><span class="co">#&gt; 2:       25817.946       23349.498       29449.609       25995.929</span></span>
<span id="cb3-91"><a href="#cb3-91"></a><span class="co">#&gt; 3:       27740.450       25144.974       25754.579       29923.176</span></span>
<span id="cb3-92"><a href="#cb3-92"></a><span class="co">#&gt; 4:       14674.490       11187.900       12831.495       13839.426</span></span>
<span id="cb3-93"><a href="#cb3-93"></a><span class="co">#&gt; 5:       50576.417       47126.037       56285.129       46257.310</span></span>
<span id="cb3-94"><a href="#cb3-94"></a><span class="co">#&gt; 6:       31905.852       30993.941       36854.351       37506.001</span></span>
<span id="cb3-95"><a href="#cb3-95"></a><span class="co">#&gt;    Abundance..129N Abundance..129C Abundance..130N Abundance..130C</span></span>
<span id="cb3-96"><a href="#cb3-96"></a><span class="co">#&gt; 1:        1874.163        2831.423        2298.401        3798.876</span></span>
<span id="cb3-97"><a href="#cb3-97"></a><span class="co">#&gt; 2:       22955.769       30578.971       30660.488       38728.853</span></span>
<span id="cb3-98"><a href="#cb3-98"></a><span class="co">#&gt; 3:       34097.637       31650.255       27632.692       23886.881</span></span>
<span id="cb3-99"><a href="#cb3-99"></a><span class="co">#&gt; 4:       12441.353       13450.885       14777.844       13039.995</span></span>
<span id="cb3-100"><a href="#cb3-100"></a><span class="co">#&gt; 5:       52634.885       49716.850       60660.574       55830.488</span></span>
<span id="cb3-101"><a href="#cb3-101"></a><span class="co">#&gt; 6:       25703.444       38626.598       35447.942       33788.409</span></span>
<span id="cb3-102"><a href="#cb3-102"></a><span class="co">#&gt;    Abundance..131 Quan.Info Ions.Score Identity.Strict Identity.Relaxed</span></span>
<span id="cb3-103"><a href="#cb3-103"></a><span class="co">#&gt; 1:       3739.067        NA         90              28               21</span></span>
<span id="cb3-104"><a href="#cb3-104"></a><span class="co">#&gt; 2:      25047.280        NA         76              24               17</span></span>
<span id="cb3-105"><a href="#cb3-105"></a><span class="co">#&gt; 3:      35331.092        NA         74              30               23</span></span>
<span id="cb3-106"><a href="#cb3-106"></a><span class="co">#&gt; 4:      12057.121        NA         40              25               18</span></span>
<span id="cb3-107"><a href="#cb3-107"></a><span class="co">#&gt; 5:      40280.577        NA         38              21               14</span></span>
<span id="cb3-108"><a href="#cb3-108"></a><span class="co">#&gt; 6:      32031.516        NA         46              29               22</span></span>
<span id="cb3-109"><a href="#cb3-109"></a><span class="co">#&gt;    Expectation.Value Percolator.q.Value Percolator.PEP</span></span>
<span id="cb3-110"><a href="#cb3-110"></a><span class="co">#&gt; 1:      7.038672e-09                  0      1.396e-05</span></span>
<span id="cb3-111"><a href="#cb3-111"></a><span class="co">#&gt; 2:      6.298627e-08                  0      3.349e-07</span></span>
<span id="cb3-112"><a href="#cb3-112"></a><span class="co">#&gt; 3:      4.318385e-07                  0      9.922e-07</span></span>
<span id="cb3-113"><a href="#cb3-113"></a><span class="co">#&gt; 4:      3.351211e-04                  0      1.175e-04</span></span>
<span id="cb3-114"><a href="#cb3-114"></a><span class="co">#&gt; 5:      2.152501e-04                  0      1.383e-05</span></span>
<span id="cb3-115"><a href="#cb3-115"></a><span class="co">#&gt; 6:      2.060469e-04                  0      7.198e-05</span></span>
<span id="cb3-116"><a href="#cb3-116"></a></span>
<span id="cb3-117"><a href="#cb3-117"></a><span class="co"># Read in annotation including condition and biological replicates per run and channel.</span></span>
<span id="cb3-118"><a href="#cb3-118"></a><span class="co"># Users should make this annotation file. It is not the output from Proteome Discoverer.</span></span>
<span id="cb3-119"><a href="#cb3-119"></a><span class="co"># annotation.pd &lt;- read.csv(file=&quot;PD_Annotation.csv&quot;, header=TRUE)</span></span>
<span id="cb3-120"><a href="#cb3-120"></a><span class="kw">head</span>(annotation.pd)</span>
<span id="cb3-121"><a href="#cb3-121"></a><span class="co">#&gt;                                            Run Fraction TechRepMixture Channel</span></span>
<span id="cb3-122"><a href="#cb3-122"></a><span class="co">#&gt; 1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01.raw        1              1     126</span></span>
<span id="cb3-123"><a href="#cb3-123"></a><span class="co">#&gt; 2 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01.raw        1              1    127N</span></span>
<span id="cb3-124"><a href="#cb3-124"></a><span class="co">#&gt; 3 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01.raw        1              1    127C</span></span>
<span id="cb3-125"><a href="#cb3-125"></a><span class="co">#&gt; 4 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01.raw        1              1    128N</span></span>
<span id="cb3-126"><a href="#cb3-126"></a><span class="co">#&gt; 5 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01.raw        1              1    128C</span></span>
<span id="cb3-127"><a href="#cb3-127"></a><span class="co">#&gt; 6 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01.raw        1              1    129N</span></span>
<span id="cb3-128"><a href="#cb3-128"></a><span class="co">#&gt;   Condition  Mixture   BioReplicate</span></span>
<span id="cb3-129"><a href="#cb3-129"></a><span class="co">#&gt; 1      Norm Mixture1  Mixture1_Norm</span></span>
<span id="cb3-130"><a href="#cb3-130"></a><span class="co">#&gt; 2     0.667 Mixture1 Mixture1_0.667</span></span>
<span id="cb3-131"><a href="#cb3-131"></a><span class="co">#&gt; 3     0.125 Mixture1 Mixture1_0.125</span></span>
<span id="cb3-132"><a href="#cb3-132"></a><span class="co">#&gt; 4       0.5 Mixture1   Mixture1_0.5</span></span>
<span id="cb3-133"><a href="#cb3-133"></a><span class="co">#&gt; 5         1 Mixture1     Mixture1_1</span></span>
<span id="cb3-134"><a href="#cb3-134"></a><span class="co">#&gt; 6     0.125 Mixture1 Mixture1_0.125</span></span>
<span id="cb3-135"><a href="#cb3-135"></a></span>
<span id="cb3-136"><a href="#cb3-136"></a><span class="co"># use Protein.Accessions as protein name</span></span>
<span id="cb3-137"><a href="#cb3-137"></a>input.pd &lt;-<span class="st"> </span><span class="kw">PDtoMSstatsTMTFormat</span>(raw.pd, annotation.pd, </span>
<span id="cb3-138"><a href="#cb3-138"></a>                                 <span class="dt">which.proteinid =</span> <span class="st">&quot;Protein.Accessions&quot;</span>)</span>
<span id="cb3-139"><a href="#cb3-139"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** Raw data from ProteomeDiscoverer imported successfully.</span></span>
<span id="cb3-140"><a href="#cb3-140"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** Raw data from ProteomeDiscoverer cleaned successfully.</span></span>
<span id="cb3-141"><a href="#cb3-141"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** Using provided annotation.</span></span>
<span id="cb3-142"><a href="#cb3-142"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** Run and Channel labels were standardized to remove symbols such as &#39;.&#39; or &#39;%&#39;.</span></span>
<span id="cb3-143"><a href="#cb3-143"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** The following options are used:</span></span>
<span id="cb3-144"><a href="#cb3-144"></a><span class="co">#&gt;   - Features will be defined by the columns: PeptideSequence, PrecursorCharge</span></span>
<span id="cb3-145"><a href="#cb3-145"></a><span class="co">#&gt;   - Shared peptides will be removed.</span></span>
<span id="cb3-146"><a href="#cb3-146"></a><span class="co">#&gt;   - Proteins with single feature will not be removed.</span></span>
<span id="cb3-147"><a href="#cb3-147"></a><span class="co">#&gt;   - Features with less than 3 measurements within each run will be removed.</span></span>
<span id="cb3-148"><a href="#cb3-148"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** Features with all missing measurements across channels within each run are removed.</span></span>
<span id="cb3-149"><a href="#cb3-149"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** Shared peptides are removed.</span></span>
<span id="cb3-150"><a href="#cb3-150"></a><span class="co">#&gt; INFO  [2023-10-24 18:03:59] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb3-151"><a href="#cb3-151"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** PSMs have been aggregated to peptide ions.</span></span>
<span id="cb3-152"><a href="#cb3-152"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Run annotation merged with quantification data.</span></span>
<span id="cb3-153"><a href="#cb3-153"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb3-154"><a href="#cb3-154"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Fractionation handled.</span></span>
<span id="cb3-155"><a href="#cb3-155"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Updated quantification data to make balanced design. Missing values are marked by NA</span></span>
<span id="cb3-156"><a href="#cb3-156"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Finished preprocessing. The dataset is ready to be processed by the proteinSummarization function.</span></span>
<span id="cb3-157"><a href="#cb3-157"></a><span class="kw">head</span>(input.pd)</span>
<span id="cb3-158"><a href="#cb3-158"></a><span class="co">#&gt;   ProteinName     PeptideSequence Charge                   PSM  Mixture</span></span>
<span id="cb3-159"><a href="#cb3-159"></a><span class="co">#&gt; 1      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-160"><a href="#cb3-160"></a><span class="co">#&gt; 2      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-161"><a href="#cb3-161"></a><span class="co">#&gt; 3      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-162"><a href="#cb3-162"></a><span class="co">#&gt; 4      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-163"><a href="#cb3-163"></a><span class="co">#&gt; 5      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-164"><a href="#cb3-164"></a><span class="co">#&gt; 6      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-165"><a href="#cb3-165"></a><span class="co">#&gt;   TechRepMixture                                         Run Channel</span></span>
<span id="cb3-166"><a href="#cb3-166"></a><span class="co">#&gt; 1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw     126</span></span>
<span id="cb3-167"><a href="#cb3-167"></a><span class="co">#&gt; 2              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb3-168"><a href="#cb3-168"></a><span class="co">#&gt; 3              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127N</span></span>
<span id="cb3-169"><a href="#cb3-169"></a><span class="co">#&gt; 4              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    128C</span></span>
<span id="cb3-170"><a href="#cb3-170"></a><span class="co">#&gt; 5              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    128N</span></span>
<span id="cb3-171"><a href="#cb3-171"></a><span class="co">#&gt; 6              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    129C</span></span>
<span id="cb3-172"><a href="#cb3-172"></a><span class="co">#&gt;     BioReplicate Condition Intensity</span></span>
<span id="cb3-173"><a href="#cb3-173"></a><span class="co">#&gt; 1  Mixture1_Norm      Norm  23398.14</span></span>
<span id="cb3-174"><a href="#cb3-174"></a><span class="co">#&gt; 2 Mixture1_0.125     0.125  22387.63</span></span>
<span id="cb3-175"><a href="#cb3-175"></a><span class="co">#&gt; 3 Mixture1_0.667     0.667  17754.91</span></span>
<span id="cb3-176"><a href="#cb3-176"></a><span class="co">#&gt; 4     Mixture1_1         1  19640.59</span></span>
<span id="cb3-177"><a href="#cb3-177"></a><span class="co">#&gt; 5   Mixture1_0.5       0.5  20048.57</span></span>
<span id="cb3-178"><a href="#cb3-178"></a><span class="co">#&gt; 6   Mixture1_0.5       0.5  19188.13</span></span>
<span id="cb3-179"><a href="#cb3-179"></a></span>
<span id="cb3-180"><a href="#cb3-180"></a><span class="co"># use Master.Protein.Accessions as protein name</span></span>
<span id="cb3-181"><a href="#cb3-181"></a>input.pd.master &lt;-<span class="st"> </span><span class="kw">PDtoMSstatsTMTFormat</span>(raw.pd, annotation.pd,</span>
<span id="cb3-182"><a href="#cb3-182"></a>                                 <span class="dt">which.proteinid =</span> <span class="st">&quot;Master.Protein.Accessions&quot;</span>)</span>
<span id="cb3-183"><a href="#cb3-183"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Raw data from ProteomeDiscoverer imported successfully.</span></span>
<span id="cb3-184"><a href="#cb3-184"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Raw data from ProteomeDiscoverer cleaned successfully.</span></span>
<span id="cb3-185"><a href="#cb3-185"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Using provided annotation.</span></span>
<span id="cb3-186"><a href="#cb3-186"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Run and Channel labels were standardized to remove symbols such as &#39;.&#39; or &#39;%&#39;.</span></span>
<span id="cb3-187"><a href="#cb3-187"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** The following options are used:</span></span>
<span id="cb3-188"><a href="#cb3-188"></a><span class="co">#&gt;   - Features will be defined by the columns: PeptideSequence, PrecursorCharge</span></span>
<span id="cb3-189"><a href="#cb3-189"></a><span class="co">#&gt;   - Shared peptides will be removed.</span></span>
<span id="cb3-190"><a href="#cb3-190"></a><span class="co">#&gt;   - Proteins with single feature will not be removed.</span></span>
<span id="cb3-191"><a href="#cb3-191"></a><span class="co">#&gt;   - Features with less than 3 measurements within each run will be removed.</span></span>
<span id="cb3-192"><a href="#cb3-192"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Features with all missing measurements across channels within each run are removed.</span></span>
<span id="cb3-193"><a href="#cb3-193"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Shared peptides are removed.</span></span>
<span id="cb3-194"><a href="#cb3-194"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:00] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb3-195"><a href="#cb3-195"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:01] ** PSMs have been aggregated to peptide ions.</span></span>
<span id="cb3-196"><a href="#cb3-196"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Run annotation merged with quantification data.</span></span>
<span id="cb3-197"><a href="#cb3-197"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb3-198"><a href="#cb3-198"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Fractionation handled.</span></span>
<span id="cb3-199"><a href="#cb3-199"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Updated quantification data to make balanced design. Missing values are marked by NA</span></span>
<span id="cb3-200"><a href="#cb3-200"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Finished preprocessing. The dataset is ready to be processed by the proteinSummarization function.</span></span>
<span id="cb3-201"><a href="#cb3-201"></a><span class="kw">head</span>(input.pd.master)</span>
<span id="cb3-202"><a href="#cb3-202"></a><span class="co">#&gt;   ProteinName     PeptideSequence Charge                   PSM  Mixture</span></span>
<span id="cb3-203"><a href="#cb3-203"></a><span class="co">#&gt; 1      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-204"><a href="#cb3-204"></a><span class="co">#&gt; 2      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-205"><a href="#cb3-205"></a><span class="co">#&gt; 3      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-206"><a href="#cb3-206"></a><span class="co">#&gt; 4      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-207"><a href="#cb3-207"></a><span class="co">#&gt; 5      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-208"><a href="#cb3-208"></a><span class="co">#&gt; 6      Q9NSD9 [K].aAGASDVVLYk.[I]      2 [K].aAGASDVVLYk.[I]_2 Mixture1</span></span>
<span id="cb3-209"><a href="#cb3-209"></a><span class="co">#&gt;   TechRepMixture                                         Run Channel</span></span>
<span id="cb3-210"><a href="#cb3-210"></a><span class="co">#&gt; 1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw     126</span></span>
<span id="cb3-211"><a href="#cb3-211"></a><span class="co">#&gt; 2              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb3-212"><a href="#cb3-212"></a><span class="co">#&gt; 3              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127N</span></span>
<span id="cb3-213"><a href="#cb3-213"></a><span class="co">#&gt; 4              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    128C</span></span>
<span id="cb3-214"><a href="#cb3-214"></a><span class="co">#&gt; 5              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    128N</span></span>
<span id="cb3-215"><a href="#cb3-215"></a><span class="co">#&gt; 6              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    129C</span></span>
<span id="cb3-216"><a href="#cb3-216"></a><span class="co">#&gt;     BioReplicate Condition Intensity</span></span>
<span id="cb3-217"><a href="#cb3-217"></a><span class="co">#&gt; 1  Mixture1_Norm      Norm  23398.14</span></span>
<span id="cb3-218"><a href="#cb3-218"></a><span class="co">#&gt; 2 Mixture1_0.125     0.125  22387.63</span></span>
<span id="cb3-219"><a href="#cb3-219"></a><span class="co">#&gt; 3 Mixture1_0.667     0.667  17754.91</span></span>
<span id="cb3-220"><a href="#cb3-220"></a><span class="co">#&gt; 4     Mixture1_1         1  19640.59</span></span>
<span id="cb3-221"><a href="#cb3-221"></a><span class="co">#&gt; 5   Mixture1_0.5       0.5  20048.57</span></span>
<span id="cb3-222"><a href="#cb3-222"></a><span class="co">#&gt; 6   Mixture1_0.5       0.5  19188.13</span></span></code></pre></div>
<p>Here is the summary of pre-processing steps in <code>PDtoMSstatsTMTFormat</code> function.</p>
<ul>
<li>Peptide ions which are shared by more than one protein are removed</li>
<li>If one spectrum has multiple identifications within one run, it only keeps the best identification with the minimal number of missing reporter ion intensities, highest reporter ion intensity, or lowest interference score if the information was available</li>
<li>If a spectrum only has one or two reporter ion intensities within one MS run, it removes the spectrum from that run</li>
<li>Ambiguous protein groups which contained multiple proteins were filtered out</li>
<li>For fractionation, If a peptide ion was shared by multiple fractions, we kept the fraction with maximal average reporter ion abundance across all the channel in the fraction.</li>
</ul>
</div>
</div>
<div id="maxqtomsstatstmtformat" class="section level3">
<h3>MaxQtoMSstatsTMTFormat()</h3>
<p>Preprocess PSM-level data from MaxQuant and convert into the required input format for MSstatsTMT.</p>
<div id="arguments-1" class="section level4">
<h4>Arguments</h4>
<ul>
<li><code>evidence</code> : name of <code>evidence.txt</code> data, which includes PSM-level data.</li>
<li><code>proteinGroups</code> : name of <code>proteinGroups.txt</code> data, which contains the detailed information of protein identifications.</li>
<li><code>annotation</code> : data frame which contains column <code>Run</code>, <code>Fraction</code>, <code>TechRepMixture</code>, <code>Channel</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Mixture</code>.</li>
<li><code>which.proteinid</code> : Use <code>Proteins</code>(default) column for protein name. <code>Leading.proteins</code> or <code>Leading.razor.proteins</code> can be used instead. However, those can potentially have the shared peptides.</li>
<li><code>rmProt_Only.identified.by.site</code> : TRUE will remove proteins with ‘+’ in ‘Only.identified.by.site’ column from proteinGroups.txt, which was identified only by a modification site. FALSE is the default.</li>
<li><code>useUniquePeptide</code> : TRUE(default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li><code>rmPSM_withfewMea_withinRun</code> : only for rmPSM_withMissing_withinRun = FALSE. TRUE(default) will remove the features that have 1 or 2 measurements within each Run.</li>
<li><code>removeProtein_with1Peptide</code> : TRUE will remove the proteins which have only 1 peptide and charge. Default is FALSE.</li>
<li><code>summaryforMultipleRows</code> : sum(default) or max - when there are multiple measurements for certain PSM in certain run, select the PSM with the largest summation or maximal value.</li>
</ul>
</div>
<div id="example-1" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Read in MaxQuant files</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># proteinGroups &lt;- read.table(&quot;proteinGroups.txt&quot;, sep=&quot;\t&quot;, header=TRUE)</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># evidence &lt;- read.table(&quot;evidence.txt&quot;, sep=&quot;\t&quot;, header=TRUE)</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># Users should make this annotation file. It is not the output from MaxQuant.</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># annotation.mq &lt;- read.csv(file=&quot;MQ_Annotation.csv&quot;, header=TRUE)</span></span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>input.mq &lt;-<span class="st"> </span><span class="kw">MaxQtoMSstatsTMTFormat</span>(evidence, proteinGroups, annotation.mq)</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Raw data from MaxQuant imported successfully.</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Rows with values of Potentialcontaminant equal to + are removed </span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Rows with values of Reverse equal to + are removed </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Rows with values of Potentialcontaminant equal to + are removed </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Rows with values of Reverse equal to + are removed </span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** + Contaminant, + Reverse, + Potential.contaminant proteins are removed.</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with all missing measurements across channels within each run are removed.</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Raw data from MaxQuant cleaned successfully.</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Using provided annotation.</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Run and Channel labels were standardized to remove symbols such as &#39;.&#39; or &#39;%&#39;.</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** The following options are used:</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt;   - Features will be defined by the columns: PeptideSequence, PrecursorCharge</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">#&gt;   - Shared peptides will be removed.</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">#&gt;   - Proteins with single feature will not be removed.</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="co">#&gt;   - Features with less than 3 measurements within each run will be removed.</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with all missing measurements across channels within each run are removed.</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Shared peptides are removed.</span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** PSMs have been aggregated to peptide ions.</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Run annotation merged with quantification data.</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Fractionation handled.</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Updated quantification data to make balanced design. Missing values are marked by NA</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Finished preprocessing. The dataset is ready to be processed by the proteinSummarization function.</span></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="kw">head</span>(input.mq)</span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="co">#&gt;   ProteinName               PeptideSequence Charge</span></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="co">#&gt; 1      P37108 AAAAAAAAAPAAAATAPTTAATTAATAAQ      3</span></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="co">#&gt; 2      P37108 AAAAAAAAAPAAAATAPTTAATTAATAAQ      3</span></span>
<span id="cb4-38"><a href="#cb4-38"></a><span class="co">#&gt; 3      P37108 AAAAAAAAAPAAAATAPTTAATTAATAAQ      3</span></span>
<span id="cb4-39"><a href="#cb4-39"></a><span class="co">#&gt; 4      P37108 AAAAAAAAAPAAAATAPTTAATTAATAAQ      3</span></span>
<span id="cb4-40"><a href="#cb4-40"></a><span class="co">#&gt; 5      P37108 AAAAAAAAAPAAAATAPTTAATTAATAAQ      3</span></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="co">#&gt; 6      P37108 AAAAAAAAAPAAAATAPTTAATTAATAAQ      3</span></span>
<span id="cb4-42"><a href="#cb4-42"></a><span class="co">#&gt;                               PSM  Mixture TechRepMixture</span></span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="co">#&gt; 1 AAAAAAAAAPAAAATAPTTAATTAATAAQ_3 Mixture1              1</span></span>
<span id="cb4-44"><a href="#cb4-44"></a><span class="co">#&gt; 2 AAAAAAAAAPAAAATAPTTAATTAATAAQ_3 Mixture1              1</span></span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="co">#&gt; 3 AAAAAAAAAPAAAATAPTTAATTAATAAQ_3 Mixture1              1</span></span>
<span id="cb4-46"><a href="#cb4-46"></a><span class="co">#&gt; 4 AAAAAAAAAPAAAATAPTTAATTAATAAQ_3 Mixture1              1</span></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="co">#&gt; 5 AAAAAAAAAPAAAATAPTTAATTAATAAQ_3 Mixture1              1</span></span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="co">#&gt; 6 AAAAAAAAAPAAAATAPTTAATTAATAAQ_3 Mixture1              1</span></span>
<span id="cb4-49"><a href="#cb4-49"></a><span class="co">#&gt;                                        Run  Channel   BioReplicate Condition</span></span>
<span id="cb4-50"><a href="#cb4-50"></a><span class="co">#&gt; 1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01 channel0  Mixture1_Norm      Norm</span></span>
<span id="cb4-51"><a href="#cb4-51"></a><span class="co">#&gt; 2 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01 channel1 Mixture1_0.667     0.667</span></span>
<span id="cb4-52"><a href="#cb4-52"></a><span class="co">#&gt; 3 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01 channel2 Mixture1_0.125     0.125</span></span>
<span id="cb4-53"><a href="#cb4-53"></a><span class="co">#&gt; 4 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01 channel3   Mixture1_0.5       0.5</span></span>
<span id="cb4-54"><a href="#cb4-54"></a><span class="co">#&gt; 5 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01 channel4     Mixture1_1         1</span></span>
<span id="cb4-55"><a href="#cb4-55"></a><span class="co">#&gt; 6 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01 channel5 Mixture1_0.125     0.125</span></span>
<span id="cb4-56"><a href="#cb4-56"></a><span class="co">#&gt;   Intensity</span></span>
<span id="cb4-57"><a href="#cb4-57"></a><span class="co">#&gt; 1    883.78</span></span>
<span id="cb4-58"><a href="#cb4-58"></a><span class="co">#&gt; 2    715.37</span></span>
<span id="cb4-59"><a href="#cb4-59"></a><span class="co">#&gt; 3   1090.60</span></span>
<span id="cb4-60"><a href="#cb4-60"></a><span class="co">#&gt; 4   1080.10</span></span>
<span id="cb4-61"><a href="#cb4-61"></a><span class="co">#&gt; 5   1006.40</span></span>
<span id="cb4-62"><a href="#cb4-62"></a><span class="co">#&gt; 6   1137.90</span></span></code></pre></div>
</div>
</div>
<div id="spectrominetomsstatstmtformat" class="section level3">
<h3>SpectroMinetoMSstatsTMTFormat()</h3>
<p>Preprocess PSM data from SpectroMine and convert into the required input format for MSstatsTMT.</p>
<div id="arguments-2" class="section level4">
<h4>Arguments</h4>
<ul>
<li><code>input</code> : data name of SpectroMine PSM output. Read PSM sheet.</li>
<li><code>annotation</code> : data frame which contains column <code>Run</code>, <code>Fraction</code>, <code>TechRepMixture</code>, <code>Channel</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Mixture</code>.</li>
<li><code>filter_with_Qvalue</code> : TRUE(default) will filter out the intensities that have greater than qvalue_cutoff in EG.Qvalue column. Those intensities will be replaced with NA and will be considered as censored missing values for imputation purpose.</li>
<li><code>qvalue_cutoff</code> : Cutoff for EG.Qvalue. default is 0.01.</li>
<li><code>useUniquePeptide</code> : TRUE(default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li><code>rmPSM_withfewMea_withinRun</code> : only for <code>rmPSM_withMissing_withinRun = FALSE</code>. TRUE(default) will remove the features that have 1 or 2 measurements within each Run.</li>
<li><code>removeProtein_with1Peptide</code> : TRUE will remove the proteins which have only 1 peptide and charge. Default is FALSE.</li>
<li><code>summaryforMultipleRows</code> : sum(default) or max - when there are multiple measurements for certain PSM in certain run, select the PSM with the largest summation or maximal value.</li>
</ul>
</div>
<div id="example-2" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Read in SpectroMine PSM report</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># raw.mine &lt;- read.csv(&#39;20180831_095547_CID-OT-MS3-Short_PSM Report_20180831_103118.xls&#39;, sep=&quot;\t&quot;)</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># Users should make this annotation file. It is not the output from SpectroMine</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># annotation.mine &lt;- read.csv(file=&quot;Mine_Annotation.csv&quot;, header=TRUE)</span></span>
<span id="cb5-6"><a href="#cb5-6"></a></span>
<span id="cb5-7"><a href="#cb5-7"></a>input.mine &lt;-<span class="st"> </span><span class="kw">SpectroMinetoMSstatsTMTFormat</span>(raw.mine, annotation.mine)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Raw data from SpectroMine imported successfully.</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Raw data from SpectroMine cleaned successfully.</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Using provided annotation.</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Run and Channel labels were standardized to remove symbols such as &#39;.&#39; or &#39;%&#39;.</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** The following options are used:</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt;   - Features will be defined by the columns: PeptideSequence, PrecursorCharge</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt;   - Shared peptides will be removed.</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;   - Proteins with single feature will not be removed.</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt;   - Features with less than 3 measurements within each run will be removed.</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Intensities with values not smaller than 0.01 in PGQValue are replaced with NA</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Intensities with values not smaller than 0.01 in Qvalue are replaced with NA</span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with all missing measurements across channels within each run are removed.</span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Shared peptides are removed.</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** PSMs have been aggregated to peptide ions.</span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Run annotation merged with quantification data.</span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** For peptides overlapped between fractions of 1_1 use the fraction with maximal average abundance.</span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Fractions belonging to same mixture have been combined.</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Fractionation handled.</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Updated quantification data to make balanced design. Missing values are marked by NA</span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Finished preprocessing. The dataset is ready to be processed by the proteinSummarization function.</span></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="kw">head</span>(input.mine)</span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co">#&gt;   ProteinName                 PeptideSequence Charge</span></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="co">#&gt; 1      P07954 [TMTNter]AAAEVNQDYGLDPK[TMTLys]      2</span></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="co">#&gt; 2      P07954 [TMTNter]AAAEVNQDYGLDPK[TMTLys]      2</span></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="co">#&gt; 3      P07954 [TMTNter]AAAEVNQDYGLDPK[TMTLys]      2</span></span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="co">#&gt; 4      P07954 [TMTNter]AAAEVNQDYGLDPK[TMTLys]      2</span></span>
<span id="cb5-36"><a href="#cb5-36"></a><span class="co">#&gt; 5      P07954 [TMTNter]AAAEVNQDYGLDPK[TMTLys]      2</span></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="co">#&gt; 6      P07954 [TMTNter]AAAEVNQDYGLDPK[TMTLys]      2</span></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="co">#&gt;                                 PSM Mixture TechRepMixture Run  Channel</span></span>
<span id="cb5-39"><a href="#cb5-39"></a><span class="co">#&gt; 1 [TMTNter]AAAEVNQDYGLDPK[TMTLys]_2       1              1 1_1 TMT6_126</span></span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="co">#&gt; 2 [TMTNter]AAAEVNQDYGLDPK[TMTLys]_2       1              1 1_1 TMT6_127</span></span>
<span id="cb5-41"><a href="#cb5-41"></a><span class="co">#&gt; 3 [TMTNter]AAAEVNQDYGLDPK[TMTLys]_2       1              1 1_1 TMT6_128</span></span>
<span id="cb5-42"><a href="#cb5-42"></a><span class="co">#&gt; 4 [TMTNter]AAAEVNQDYGLDPK[TMTLys]_2       1              1 1_1 TMT6_129</span></span>
<span id="cb5-43"><a href="#cb5-43"></a><span class="co">#&gt; 5 [TMTNter]AAAEVNQDYGLDPK[TMTLys]_2       1              1 1_1 TMT6_130</span></span>
<span id="cb5-44"><a href="#cb5-44"></a><span class="co">#&gt; 6 [TMTNter]AAAEVNQDYGLDPK[TMTLys]_2       1              1 1_1 TMT6_131</span></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="co">#&gt;   BioReplicate Condition Intensity</span></span>
<span id="cb5-46"><a href="#cb5-46"></a><span class="co">#&gt; 1            1         3  6393.694</span></span>
<span id="cb5-47"><a href="#cb5-47"></a><span class="co">#&gt; 2            2         3  7887.951</span></span>
<span id="cb5-48"><a href="#cb5-48"></a><span class="co">#&gt; 3            3         3  9917.544</span></span>
<span id="cb5-49"><a href="#cb5-49"></a><span class="co">#&gt; 4            1         1 11282.770</span></span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="co">#&gt; 5            2         1  8544.471</span></span>
<span id="cb5-51"><a href="#cb5-51"></a><span class="co">#&gt; 6            3         1  4893.753</span></span></code></pre></div>
</div>
</div>
<div id="openmstomsstatstmtformat" class="section level3">
<h3>OpenMStoMSstatsTMTFormat()</h3>
<p>Preprocess MSstatsTMT report from OpenMS and convert into the required input format for MSstatsTMT.</p>
<div id="arguments-3" class="section level4">
<h4>Arguments</h4>
<ul>
<li><code>input</code> : data name of MSstatsTMT report from OpenMS. Read csv file.</li>
<li><code>useUniquePeptide</code> : TRUE(default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li><code>rmPSM_withfewMea_withinRun</code> : only for rmPSM_withMissing_withinRun = FALSE. TRUE(default) will remove the features that have 1 or 2 measurements within each Run.</li>
<li><code>removeProtein_with1Peptide</code> : TRUE will remove the proteins which have only 1 peptide and charge. Default is FALSE.</li>
<li><code>summaryforMultipleRows</code> : sum(default) or max - when there are multiple measurements for certain PSM in certain run, select the PSM with the largest summation or maximal value.</li>
</ul>
</div>
<div id="example-3" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># read in MSstatsTMT report from OpenMS</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># raw.om &lt;- read.csv(&quot;OpenMS_20200222/20200225_MSstatsTMT_OpenMS_Export.csv&quot;)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">head</span>(raw.om)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt;   RetentionTime          ProteinName                 PeptideSequence Charge</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; 1      2924.491 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; 2      2924.491 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; 3      2924.491 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; 4      2924.491 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; 5      2924.491 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; 6      2924.491 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt;   Channel Condition BioReplicate   Run Mixture TechRepMixture Fraction</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; 1       1   Long_LF            1 1_1_3       1            1_1        3</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; 2       2   Long_LF            2 1_1_3       1            1_1        3</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt; 3       3    Long_M            3 1_1_3       1            1_1        3</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; 4       6    Long_M            6 1_1_3       1            1_1        3</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; 5       5      Norm            5 1_1_3       1            1_1        3</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; 6       9      Norm            9 1_1_3       1            1_1        3</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt;   Intensity</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; 1  5727.319</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; 2  6985.365</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt; 3  4553.897</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; 4  5937.782</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt; 5  5151.292</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt; 6  6800.128</span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt;                                                                                                          Reference</span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">#&gt; 1 PAMI-176_Mouse_A-J_TMT_40ug_22pctACN_25cm_120min_20160223_OT.mzML_controllerType=0 controllerNumber=1 scan=11324</span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">#&gt; 2 PAMI-176_Mouse_A-J_TMT_40ug_22pctACN_25cm_120min_20160223_OT.mzML_controllerType=0 controllerNumber=1 scan=11324</span></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co">#&gt; 3 PAMI-176_Mouse_A-J_TMT_40ug_22pctACN_25cm_120min_20160223_OT.mzML_controllerType=0 controllerNumber=1 scan=11324</span></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co">#&gt; 4 PAMI-176_Mouse_A-J_TMT_40ug_22pctACN_25cm_120min_20160223_OT.mzML_controllerType=0 controllerNumber=1 scan=11324</span></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co">#&gt; 5 PAMI-176_Mouse_A-J_TMT_40ug_22pctACN_25cm_120min_20160223_OT.mzML_controllerType=0 controllerNumber=1 scan=11324</span></span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="co">#&gt; 6 PAMI-176_Mouse_A-J_TMT_40ug_22pctACN_25cm_120min_20160223_OT.mzML_controllerType=0 controllerNumber=1 scan=11324</span></span>
<span id="cb6-32"><a href="#cb6-32"></a></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co"># the function only requries one input file</span></span>
<span id="cb6-34"><a href="#cb6-34"></a>input.om &lt;-<span class="st"> </span><span class="kw">OpenMStoMSstatsTMTFormat</span>(raw.om)</span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Raw data from OpenMS imported successfully.</span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Raw data from OpenMS cleaned successfully.</span></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** The following options are used:</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co">#&gt;   - Features will be defined by the columns: PeptideSequence, PrecursorCharge</span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co">#&gt;   - Shared peptides will be removed.</span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="co">#&gt;   - Proteins with single feature will not be removed.</span></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="co">#&gt;   - Features with less than 3 measurements within each run will be removed.</span></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with all missing measurements across channels within each run are removed.</span></span>
<span id="cb6-43"><a href="#cb6-43"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Shared peptides are removed.</span></span>
<span id="cb6-44"><a href="#cb6-44"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb6-45"><a href="#cb6-45"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** PSMs have been aggregated to peptide ions.</span></span>
<span id="cb6-46"><a href="#cb6-46"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** For peptides overlapped between fractions of 2_2_2 use the fraction with maximal average abundance.</span></span>
<span id="cb6-47"><a href="#cb6-47"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** For peptides overlapped between fractions of 3_3_3 use the fraction with maximal average abundance.</span></span>
<span id="cb6-48"><a href="#cb6-48"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Fractions belonging to same mixture have been combined.</span></span>
<span id="cb6-49"><a href="#cb6-49"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Features with one or two measurements across channels within each run are removed.</span></span>
<span id="cb6-50"><a href="#cb6-50"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Fractionation handled.</span></span>
<span id="cb6-51"><a href="#cb6-51"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Updated quantification data to make balanced design. Missing values are marked by NA</span></span>
<span id="cb6-52"><a href="#cb6-52"></a><span class="co">#&gt; INFO  [2023-10-24 18:04:02] ** Finished preprocessing. The dataset is ready to be processed by the proteinSummarization function.</span></span>
<span id="cb6-53"><a href="#cb6-53"></a><span class="kw">head</span>(input.om)</span>
<span id="cb6-54"><a href="#cb6-54"></a><span class="co">#&gt;            ProteinName                 PeptideSequence Charge</span></span>
<span id="cb6-55"><a href="#cb6-55"></a><span class="co">#&gt; 1 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-56"><a href="#cb6-56"></a><span class="co">#&gt; 2 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-57"><a href="#cb6-57"></a><span class="co">#&gt; 3 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-58"><a href="#cb6-58"></a><span class="co">#&gt; 4 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-59"><a href="#cb6-59"></a><span class="co">#&gt; 5 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-60"><a href="#cb6-60"></a><span class="co">#&gt; 6 sp|P11679|K2C8_MOUSE .(TMT6plex)AEAETMYQIK(TMT6plex)      2</span></span>
<span id="cb6-61"><a href="#cb6-61"></a><span class="co">#&gt;                                 PSM Mixture TechRepMixture   Run Channel</span></span>
<span id="cb6-62"><a href="#cb6-62"></a><span class="co">#&gt; 1 .(TMT6plex)AEAETMYQIK(TMT6plex)_2       1            1_1 1_1_1       1</span></span>
<span id="cb6-63"><a href="#cb6-63"></a><span class="co">#&gt; 2 .(TMT6plex)AEAETMYQIK(TMT6plex)_2       1            1_1 1_1_1       2</span></span>
<span id="cb6-64"><a href="#cb6-64"></a><span class="co">#&gt; 3 .(TMT6plex)AEAETMYQIK(TMT6plex)_2       1            1_1 1_1_1       3</span></span>
<span id="cb6-65"><a href="#cb6-65"></a><span class="co">#&gt; 4 .(TMT6plex)AEAETMYQIK(TMT6plex)_2       1            1_1 1_1_1       4</span></span>
<span id="cb6-66"><a href="#cb6-66"></a><span class="co">#&gt; 5 .(TMT6plex)AEAETMYQIK(TMT6plex)_2       1            1_1 1_1_1       5</span></span>
<span id="cb6-67"><a href="#cb6-67"></a><span class="co">#&gt; 6 .(TMT6plex)AEAETMYQIK(TMT6plex)_2       1            1_1 1_1_1       6</span></span>
<span id="cb6-68"><a href="#cb6-68"></a><span class="co">#&gt;   BioReplicate Condition Intensity</span></span>
<span id="cb6-69"><a href="#cb6-69"></a><span class="co">#&gt; 1            1   Long_LF  5727.319</span></span>
<span id="cb6-70"><a href="#cb6-70"></a><span class="co">#&gt; 2            2   Long_LF  6985.365</span></span>
<span id="cb6-71"><a href="#cb6-71"></a><span class="co">#&gt; 3            3    Long_M  4553.897</span></span>
<span id="cb6-72"><a href="#cb6-72"></a><span class="co">#&gt; 4            4  Short_LF  6277.917</span></span>
<span id="cb6-73"><a href="#cb6-73"></a><span class="co">#&gt; 5            5      Norm  5151.292</span></span>
<span id="cb6-74"><a href="#cb6-74"></a><span class="co">#&gt; 6            6    Long_M  5937.782</span></span></code></pre></div>
</div>
</div>
<div id="philosophertomsstatstmtformat" class="section level3">
<h3>PhilosophertoMSstatsTMTFormat()</h3>
<p>Preprocess MSstats report from Philosopher of Fragpipe and convert into the required input format for MSstatsTMT.</p>
<div id="arguments-4" class="section level4">
<h4>Arguments</h4>
<ul>
<li><code>input</code> : list of tables exported by Philosopher. Fragpipe produces a csv file for each TMT mixture.</li>
<li><code>path</code> : a path to the folder with all the Philosopher msstats csv files. Fragpipe produces a msstats.csv file for each TMT mixture.</li>
<li><code>folder</code> : logical, if TRUE, path parameter will be treated as folder path and all msstats*.csv files will be imported. If FALSE, path parameter will be treated as a vector of fixed file paths.</li>
<li><code>annotation</code> : annotation with Run, Fraction, TechRepMixture, Mixture, Channel, BioReplicate, Condition columns or a path to file. Refer to the example ‘annotation’ for the meaning of each column. Channel column should be consistent with the channel columns (Ignore the prefix “Channel”) in msstats.csv file. Run column should be consistent with the Spectrum.File columns in msstats.csv file.</li>
<li><code>protein_id_col</code> : Use ‘Protein.Accessions’(default) column for protein name. ‘Master.Protein.Accessions’ can be used instead to get the protein ID with single protein.</li>
<li><code>peptide_id_col</code> : Use ‘Peptide.Sequence’(default) column for peptide sequence. ‘Modified.Peptide.Sequence’ can be used instead to get the modified peptide sequence.</li>
<li><code>Purity_cutoff</code> : Cutoff for purity. Default is 0.6</li>
<li><code>PeptideProphet_prob_cutoff</code> : Cutoff for the peptide identification probability. Default is 0.7.</li>
<li><code>useUniquePeptide</code> : logical, if TRUE (default) removes peptides that are assigned for more than one proteins. We assume to use unique peptide for each protein.</li>
<li><code>rmPSM_withfewMea_withinRun</code> : TRUE(default) will remove the features that have 1 or 2 measurements within each Run.</li>
<li><code>rmPeptide_OxidationM</code> : TRUE (default) will remove the peptides including oxidation (M) sequence.</li>
<li><code>removeProtein_with1Peptide</code> : TRUE will remove the proteins which have only 1 peptide and charge. Default is FALSE.</li>
<li><code>summaryforMultipleRows</code> : sum(default) or max - when there are multiple measurements for certain PSM in certain run, select the PSM with the largest summation or maximal value.</li>
</ul>
</div>
<div id="example-4" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Example code is skipped for Philosopher Converter </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># since the input is a path to the folder with all the Philosopher msstats csv files</span></span></code></pre></div>
</div>
</div>
</div>
<div id="protein-summarization-normalization-and-visualization" class="section level2">
<h2>2. Protein summarization, normalization and visualization</h2>
<div id="proteinsummarization" class="section level3">
<h3>2.1. proteinSummarization()</h3>
<p>After reading the input files and get the data with required format, <code>MSstatsTMT</code> performs</p>
<ul>
<li><ol style="list-style-type: decimal">
<li>logarithm transformation of <code>Intensity</code> column</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>global median normalization between channels</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>protein summarization per MS run and channel</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>local protein-level normalization with reference channel</li>
</ol></li>
</ul>
<p>Global median normalization is first applied to peptide level quantification data (equalizing the medians across all the channels and MS runs). Protein summarization from peptide level quantification should be performed before testing differentially abundant proteins. Then, normalization between MS runs using reference channels will be implemented. In particular, protein summarization method <code>MSstats</code> assumes missing values are censored and then imputes the missing values before summarizing peptide level data into protein level data. Other methods, including <code>MedianPolish</code>, <code>Median</code> and <code>LogSum</code>, do not impute missing values.</p>
<div id="arguments-5" class="section level4">
<h4>Arguments</h4>
<ul>
<li><code>data</code> : Name of the output of PDtoMSstatsTMTFormat function or peptide-level quantified data from other tools. It should have columns named <code>Protein</code>, <code>PSM</code>, <code>TechRepMixture</code>, <code>Mixture</code>, <code>Run</code>, <code>Channel</code>, <code>Condition</code>, <code>BioReplicate</code>, <code>Intensity</code>.</li>
<li><code>method</code> : Four different summarization methods to protein-level can be performed : <code>msstats</code>(default), <code>MedianPolish</code>, <code>Median</code>, <code>LogSum</code>.</li>
<li><code>global_norm</code> : Global median normalization on peptide level data (equalizing the medians across all the channels and MS runs). Default is TRUE. It will be performed before protein-level summarization.</li>
<li><code>reference_norm</code> : Reference channel based normalization between MS runs. TRUE(default) needs at least one reference channel in each MS run, annotated by <code>Norm</code> in Condtion column. It will be performed after protein-level summarization. FALSE will not perform this normalization step. If data only has one run, then reference_norm=FALSE.</li>
<li><code>remove_norm_channel</code> : TRUE(default) removes <code>Norm</code> channels from protein level data.</li>
<li><code>remove_empty_channel</code> : TRUE(default) removes <code>Empty</code> channels from protein level data.</li>
<li><code>MBimpute</code> : only for <code>method = &quot;msstats&quot;</code>. TRUE (default) imputes missing values by Accelated failure model. FALSE uses minimum value to impute the missing value for each peptide precursor ion.</li>
<li><code>maxQuantileforCensored</code> : We assume missing values are censored. <code>maxQuantileforCensored</code> is Maximum quantile for deciding censored missing value, for instance, 0.999. Default is Null.</li>
</ul>
</div>
<div id="example-5" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># use MSstats for protein summarization</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>quant.msstats &lt;-<span class="st"> </span><span class="kw">proteinSummarization</span>(input.pd,</span>
<span id="cb8-3"><a href="#cb8-3"></a>                                      <span class="dt">method=</span><span class="st">&quot;msstats&quot;</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>                                      <span class="dt">global_norm=</span><span class="ot">TRUE</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>                                      <span class="dt">reference_norm=</span><span class="ot">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>                                      <span class="dt">remove_norm_channel =</span> <span class="ot">TRUE</span>,</span>
<span id="cb8-7"><a href="#cb8-7"></a>                                      <span class="dt">remove_empty_channel =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">head</span>(quant.pd.msstats<span class="op">$</span>ProteinLevelData)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt;    Mixture TechRepMixture                                         Run Channel</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; 1 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; 2 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; 3 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; 4 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; 5 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt; 6 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;   Protein Abundance BioReplicate Condition</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; 1  P04406  16.59812        0.125     0.125</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; 2  P06576  15.55891        0.125     0.125</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt; 3  P12277  15.28471        0.125     0.125</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; 4  P23919  15.20871        0.125     0.125</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; 5  P31947  14.86975        0.125     0.125</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; 6  Q15233  14.57543        0.125     0.125</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># use Median for protein summarization</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>quant.median &lt;-<span class="st"> </span><span class="kw">proteinSummarization</span>(input.pd,</span>
<span id="cb10-3"><a href="#cb10-3"></a>                                     <span class="dt">method=</span><span class="st">&quot;Median&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>                                     <span class="dt">global_norm=</span><span class="ot">TRUE</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                                     <span class="dt">reference_norm=</span><span class="ot">TRUE</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>                                     <span class="dt">remove_norm_channel =</span> <span class="ot">TRUE</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>                                     <span class="dt">remove_empty_channel =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">head</span>(quant.median<span class="op">$</span>ProteinLevelData)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt;    Mixture TechRepMixture                                         Run Channel</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; 1 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; 2 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; 3 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; 4 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; 5 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; 6 Mixture1              1 161117_SILAC_HeLa_UPS1_TMT10_Mixture1_01raw    127C</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt;   Protein Abundance   BioReplicate Condition</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; 1  Q9NSD9  15.33397 Mixture1_0.125     0.125</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; 2  P04406  16.39393 Mixture1_0.125     0.125</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; 3  Q15233  14.69981 Mixture1_0.125     0.125</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; 4  Q16181  13.83691 Mixture1_0.125     0.125</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; 5  P12277  15.06154 Mixture1_0.125     0.125</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; 6  P23919  14.89041 Mixture1_0.125     0.125</span></span></code></pre></div>
</div>
</div>
<div id="dataprocessplotstmt" class="section level3">
<h3>2.2 dataProcessPlotsTMT()</h3>
<p>Visualization for explanatory data analysis. To illustrate the quantitative data after data-preprocessing and quality control of TMT runs, dataProcessPlotsTMT takes the quantitative data and summarized data from function <code>proteinSummarization</code> as input. It generates two types of figures in pdf files as output :</p>
<ol style="list-style-type: decimal">
<li><p>profile plot (specify “ProfilePlot” in option type), to identify the potential sources of variation for each protein;</p></li>
<li><p>quality control plot (specify “QCPlot” in option type), to evaluate the systematic bias between MS runs and channels.</p></li>
</ol>
<div id="arguments-6" class="section level4">
<h4>Arguments</h4>
<ul>
<li><code>data</code> : the output of <code>proteinSummarization</code> function. It is a list with data frames <code>FeatureLevelData</code> and <code>ProteinLevelData</code></li>
<li><code>type</code> : choice of visualization. “ProfilePlot” represents profile plot of log intensities across MS runs. “QCPlot” represents quality control plot of log intensities across MS runs.</li>
<li><code>ylimUp</code> : upper limit for y-axis in the log scale. FALSE(Default) for Profile Plot and QC Plot use the upper limit as rounded off maximum of log2(intensities) after normalization + 3.</li>
<li><code>ylimDown</code> : lower limit for y-axis in the log scale. FALSE(Default) for Profile Plot and QC Plot is 0.</li>
<li><code>x.axis.size</code> : size of x-axis labeling for “Run” and “channel” in Profile Plot and QC Plot.</li>
<li><code>y.axis.size</code> : size of y-axis labels. Default is 10.</li>
<li><code>text.size</code> : size of labels represented each condition at the top of graph in Profile Plot and QC plot. Default is 4.</li>
<li><code>text.angle</code> : angle of labels represented each condition at the top of graph in Profile Plot and QC plot. Default is 0.</li>
<li><code>legend.size</code> : size of legend above graph in Profile Plot. Default is 7.</li>
<li><code>dot.size.profile</code> : size of dots in profile plot. Default is 2.</li>
<li><code>ncol.guide</code> : number of columns for legends at the top of plot. Default is 5.</li>
<li><code>width</code> : width of the saved file. Default is 10.</li>
<li><code>height</code> : height of the saved file. Default is 10.</li>
<li><code>which.Protein</code> : Protein list to draw plots. List can be names of Proteins or order numbers of Proteins. Default is “all”, which generates all plots for each protein. For QC plot, “allonly” will generate one QC plot with all proteins.</li>
<li><code>originalPlot</code> : TRUE(default) draws original profile plots, without normalization.</li>
<li><code>summaryPlot</code> : TRUE(default) draws profile plots with protein summarization for each channel and MS run.</li>
<li><code>address</code> : the name of folder that will store the results. Default folder is the current working directory. The other assigned folder has to be existed under the current working directory. An output pdf file is automatically created with the default name of “ProfilePlot.pdf” or “QCplot.pdf”. The command address can help to specify where to store the file as well as how to modify the beginning of the file name. If address=FALSE, plot will be not saved as pdf file but showed in window.</li>
</ul>
</div>
<div id="example-6" class="section level4">
<h4>Example</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">## Profile plot without norm channnels and empty channels</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">dataProcessPlotsTMT</span>(<span class="dt">data=</span>quant.msstats,</span>
<span id="cb12-3"><a href="#cb12-3"></a>                     <span class="dt">type =</span> <span class="st">&#39;ProfilePlot&#39;</span>,</span>
<span id="cb12-4"><a href="#cb12-4"></a>                     <span class="dt">width =</span> <span class="dv">21</span>, <span class="co"># adjust the figure width since there are 15 TMT runs.</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>                     <span class="dt">height =</span> <span class="dv">7</span>)</span></code></pre></div>
<p>There are two pdfs with all the proteins, first is profile plot and second plot is profile plot with summarized and normalized data. <code>XXX_ProfilePlot.pdf</code> shows each peptide ions across runs and channels, grouped per condition. Each panel represents one MS run and each dot within one panel is one channel within one Run. Each peptide has a different colour/type layout. The dots are linked with line per peptide ion If line is disconnected, that means there is no value (missing value). Profile plot is good visualization to check individual measurements. <code>XXX_ProfilePlot_wSummarization.pdf</code> shows the same peptide ions in grey, with the values as summarized by the model overlayed in red.</p>
<p>Instead of making all profile plots for all proteins, we can make plot for individual protein. Here is the example of protein<code>P04406</code></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">dataProcessPlotsTMT</span>(<span class="dt">data=</span>quant.msstats,</span>
<span id="cb13-2"><a href="#cb13-2"></a>                    <span class="dt">type=</span><span class="st">&#39;ProfilePlot&#39;</span>, <span class="co"># choice of visualization</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>                    <span class="dt">width =</span> <span class="dv">21</span>,</span>
<span id="cb13-4"><a href="#cb13-4"></a>                    <span class="dt">height =</span> <span class="dv">7</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>                    <span class="dt">which.Protein =</span> <span class="st">&#39;P04406&#39;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">## Quality control plot </span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># dataProcessPlotsTMT(data=quant.msstats, </span></span>
<span id="cb14-3"><a href="#cb14-3"></a>                     <span class="co"># type=&#39;QCPlot&#39;,</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>                     <span class="co"># width = 21, # adjust the figure width since there are 15 TMT runs. </span></span>
<span id="cb14-5"><a href="#cb14-5"></a>                     <span class="co"># height = 7)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="groupcomparisontmt" class="section level2">
<h2>3. groupComparisonTMT()</h2>
<p>Tests for significant changes in protein abundance across conditions based on a family of linear mixed-effects models in TMT experiment. Experimental design of case-control study (patients are not repeatedly measured) is automatically determined based on proper statistical model.</p>
<div id="arguments-7" class="section level3">
<h3>Arguments</h3>
<ul>
<li><code>data</code> : the output of <code>proteinSummarization</code> function. It is a list with data frames <code>FeatureLevelData</code> and <code>ProteinLevelData</code></li>
<li><code>contrast.matrix</code> : Comparison between conditions of interests. 1) default is <code>pairwise</code>, which compare all possible pairs between two conditions. 2) Otherwise, users can specify the comparisons of interest. Based on the levels of conditions, specify 1 or -1 to the conditions of interests and 0 otherwise. The levels of conditions are sorted alphabetically.</li>
<li><code>moderated</code> : If moderated = TRUE, then moderated t statistic will be calculated; otherwise, ordinary t statistic will be used.</li>
<li><code>adj.method</code> : adjusted method for multiple comparison. ’BH` is default.</li>
<li><code>save_fitted_models</code>: logical, if TRUE, fitted models will be added to</li>
<li><code>remove_norm_channel</code> : TRUE(default) removes <code>Norm</code> channels from protein level data.</li>
<li><code>remove_empty_channel</code> : TRUE(default) removes <code>Empty</code> channels from protein level data.</li>
</ul>
<p>If you want to make all the pairwise comparison,<code>MSstatsTMT</code> has an easy option for it. Setting <code>contrast.matrix = pairwise</code> compares all the possible pairs between two conditions.</p>
</div>
<div id="example-7" class="section level3">
<h3>Example</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># test for all the possible pairs of conditions</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>test.pairwise &lt;-<span class="st"> </span><span class="kw">groupComparisonTMT</span>(quant.msstats, <span class="dt">moderated =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Show test result</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co"># Label : which comparison is used</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co"># log2FC : estimated log2 fold change between two conditions (the contrast)</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># adj.pvalue : adjusted p value</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="kw">head</span>(test.pairwise<span class="op">$</span>ComparisonResult)</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt;    Protein          Label       log2FC         SE       DF    pvalue adj.pvalue</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; 1:  P04406 0.125 vs 0.667 -0.010442843 0.02604088 43.37604 0.6903760  0.9855065</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; 2:  P04406     0.125 vs 1 -0.005921016 0.02604088 43.37604 0.8212013  0.9656146</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; 3:  P04406   0.125 vs 0.5 -0.031373953 0.02604088 43.37604 0.2348144  0.6884275</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt; 4:  P04406     0.667 vs 1  0.004521827 0.02604088 43.37604 0.8629535  0.9540600</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt; 5:  P04406   0.667 vs 0.5 -0.020931110 0.02604088 43.37604 0.4259078  0.7655582</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#&gt; 6:  P04406       1 vs 0.5 -0.025452937 0.02604088 43.37604 0.3337801  0.8551737</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#&gt;    issue</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">#&gt; 1:    NA</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">#&gt; 2:    NA</span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">#&gt; 3:    NA</span></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="co">#&gt; 4:    NA</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="co">#&gt; 5:    NA</span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co">#&gt; 6:    NA</span></span></code></pre></div>
<p>If you would like to compare some specific combination of conditions, you need to tell <code>groupComparisonTMT</code> the contrast of the conditions to compare. You can make your <code>contrast.matrix</code> in R in a text editor. We define our contrast matrix by adding a column for every condition. We add a row for every comparison we would like to make between groups of conditions.</p>
<p><strong>0</strong> is for conditions we would like to ignore. <strong>1</strong> is for conditions we would like to put in the numerator of the ratio or fold-change. <strong>-1</strong> is for conditions we would like to put in the denumerator of the ratio or fold-change.</p>
<p>If you have multiple groups, you can assign any group comparisons you are interested in.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Check the conditions in the protein level data</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">levels</span>(quant.msstats<span class="op">$</span>ProteinLevelData<span class="op">$</span>Condition)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt; [1] &quot;0.125&quot; &quot;0.5&quot;   &quot;0.667&quot; &quot;1&quot;</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># Only compare condition 0.125 and 1</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>comparison&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">1</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co"># Set the names of each row</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="kw">row.names</span>(comparison)&lt;-<span class="st">&quot;1-0.125&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co"># Set the column names</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="kw">colnames</span>(comparison)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;0.125&quot;</span>, <span class="st">&quot;0.5&quot;</span>, <span class="st">&quot;0.667&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb17-10"><a href="#cb17-10"></a>comparison</span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#&gt;         0.125 0.5 0.667 1</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#&gt; 1-0.125    -1   0     0 1</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>test.contrast &lt;-<span class="st"> </span><span class="kw">groupComparisonTMT</span>(<span class="dt">data =</span> quant.msstats, <span class="dt">contrast.matrix =</span> comparison, <span class="dt">moderated =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">head</span>(test.contrast<span class="op">$</span>ComparisonResult)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#&gt;    Protein   Label       log2FC         SE       DF    pvalue adj.pvalue issue</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt; 1:  P04406 1-0.125  0.005921016 0.02604088 43.37604 0.8212013  0.9656146    NA</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt; 2:  P06576 1-0.125 -0.001284321 0.02962229 43.74848 0.9656146  0.9656146    NA</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">#&gt; 3:  P12277 1-0.125 -0.013004897 0.03874807 40.31591 0.7388926  0.9656146    NA</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">#&gt; 4:  P23919 1-0.125  0.031852508 0.03691476 43.22630 0.3929732  0.7859463    NA</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">#&gt; 5:  P31947 1-0.125  0.034549433 0.03955270 42.00057 0.3873557  0.7859463    NA</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">#&gt; 6:  Q15233 1-0.125  0.010110290 0.03056908 43.19538 0.7424430  0.9656146    NA</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
