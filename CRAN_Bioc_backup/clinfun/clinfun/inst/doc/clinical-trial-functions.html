<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Functions For Clinical Trial Design</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Functions For Clinical Trial Design</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette walks through functions in {clinfun} that facilitate the design of clinical trials. Examples using published clinical trials are included to illustrate the use of these functions in a real-world context.</p>
<p>To begin, install and load {clinfun}:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(clinfun)</span></code></pre></div>
</div>
<div id="phase-ii-trial-design" class="section level1">
<h1>Phase II Trial Design</h1>
<p>The overall purpose of phase II research is to determine whether a treatment is promising enough to warrant more extensive development. While phase I research assesses safety and clinical pharmacology, phase II research begins assessing the efficacy of a treatment in a well-defined population, while continuing to monitor the safety of the treatment. {clinfun} enables users to construct two common phase II trial designs, Simon’s two-stage and single-stage, which are described in more detail below.</p>
<div id="simons-two-stage" class="section level2">
<h2>Simon’s Two-Stage</h2>
<p>The goal of Simon’s two-stage design is to assess the efficacy of a treatment while minimizing the number of patients exposed to an ineffective treatment.</p>
<p>The trial begins by enrolling <span class="math inline">\(n_1\)</span> patients in stage 1. If <span class="math inline">\(\leq r_1\)</span> responses are observed, then early termination occurs, at which point the treatment is not recommended. Otherwise, <span class="math inline">\(n_2\)</span> patients are enrolled in stage 2 and the success of the treatment is based on all data accumulated. At the end of stage 2, if <span class="math inline">\(\leq r\)</span> responses have been observed in total, then the treatment is not recommended; if <span class="math inline">\(&gt;r\)</span> responses have been observed in total, then the treatment is recommended.</p>
<p>When designing a Simon’s two-stage trial, the key objective is to determine appropriate response threshold and sample size values, indicated by:</p>
<ul>
<li><p><span class="math inline">\(r_1\)</span>: Response threshold at the end of stage 1</p></li>
<li><p><span class="math inline">\(r\)</span>: Final response threshold</p></li>
<li><p><span class="math inline">\(n_1\)</span>: Stage 1 sample size</p></li>
<li><p><span class="math inline">\(n\)</span>: Total sample size (<span class="math inline">\(n_1 + n_2\)</span>)</p></li>
</ul>
<div id="design-parameters-and-constraints" class="section level3">
<h3>Design Parameters and Constraints</h3>
<p>In order to determine final design components, the following parameters and constraints must be specified:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): Treatment response rate considered unacceptable</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): Treatment response rate considered desirable</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): Type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): Type II error threshold</p></li>
</ul>
<p>The final design components depend on the response rates considered “unacceptable” (<span class="math inline">\(p_0\)</span>) and “desirable” (<span class="math inline">\(p_1\)</span>) and must satisfy the desired error rate constraints (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) for testing the following hypotheses:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true treatment response rate is less than or equal to some unacceptable level (<span class="math inline">\(p \leq p_0\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true treatment response rate is greater than or equal to some desirable level (<span class="math inline">\(p \geq p_1\)</span>)</p></li>
</ul>
</div>
<div id="optimal-vs.-minimax-vs.-admissible-designs" class="section level3">
<h3>Optimal vs. Minimax vs. Admissible Designs</h3>
<p>Once the design parameters and constraints are provided, {clinfun} determines the final design components based on three different approaches: optimal, minimax, and admissible.</p>
<p>If early termination occurs, the sample size for the trial is <span class="math inline">\(n_1\)</span>. If early termination does not occur, the sample size for the trial is <span class="math inline">\(n\)</span> (the maximum sample size for the trial).</p>
<p>Thus, the expected sample size under the null hypothesis is given by</p>
<p><span class="math display">\[ EN(p_0) = n_1 + (1 - PET(p_0)) \cdot n_2 \]</span></p>
<p>where <span class="math inline">\(PET(p_0)\)</span> is the probability of early termination under the null hypothesis.</p>
<p>The <strong>optimal design</strong> minimizes the expected sample size (<span class="math inline">\(EN(p_0)\)</span>), whereas the <strong>minimax design</strong> minimizes the maximum sample size (<span class="math inline">\(n_1 + n_2\)</span>). The optimal design typically has a smaller stage 1 sample size but more subjects overall if the trial proceeds to stage 2. The optimal design also typically has a higher <span class="math inline">\(PET(p_0)\)</span> than the minimax design. The minimax design can be preferable in certain scenarios: for example, if <span class="math inline">\(EN(p_0)\)</span> is relatively close to that of the optimal design and the patient accrual rate is slow, or if the patient population is heterogeneous and a small stage 1 is not desirable.</p>
<p>The <strong>admissible design</strong> can be thought of as a compromise between the optimal and minimax designs and is based on a Bayesian decision-theoretic criterion.</p>
</div>
<div id="levatinib-phase-ii-trial-example" class="section level3">
<h3>Levatinib Phase II Trial Example</h3>
<p>For this example, we will be looking at a phase II trial that assessed the efficacy of lenvatinib in patients with progressive, recurrent or metastatic adenoid cystic carcinoma (Tchekmedyian et al., 2019). Patients received lenvatinib 24 mg/day. Treatment was continued until disease progression, death, unacceptable toxicity, withdrawal of consent, or a decision based on the treating physician’s discretion. Treatment response was specifically defined as overall response: achievement of either partial response or complete response, as defined by Response Evaluation Criteria in Solid Tumors (RECIST) version 1.1.</p>
<p>The trial employed a Simon’s two-stage design. An overall response rate of 5% was considered unacceptable, and an overall response rate of 20% was considered desirable. The type I error threshold used was 10%. The target power used was 90%, equivalent to a 10% type II error threshold.</p>
<p>Summarizing the design parameters and constraints from above, we have:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): 5% overall response rate</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): 20% overall response rate</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): 10% type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): 10% type II error threshold</p></li>
</ul>
<p>Thus, the hypotheses used for testing are:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true overall response rate is less than or equal to 5% (<span class="math inline">\(p \leq 0.05\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true overall response rate is greater than or equal to 20% (<span class="math inline">\(p \geq 0.2%\)</span>)</p></li>
</ul>
<p>Now, using <code>ph2simon()</code>, specify these parameters and print the resulting object.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># Specify the parameters and constraints</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>trial =<span class="st"> </span><span class="kw">ph2simon</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co"># Print</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>trial</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="co">#&gt;  Simon 2-stage Phase II design </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="co">#&gt; Unacceptable response rate:  0.05 </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a><span class="co">#&gt; Desirable response rate:  0.2 </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a><span class="co">#&gt; Error rates: alpha =  0.1 ; beta =  0.1 </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="co">#&gt;            r1 n1 r  n EN(p0) PET(p0)   qLo   qHi</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a><span class="co">#&gt; Minimax     0 18 3 32  26.44  0.3972 0.640 1.000</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a><span class="co">#&gt; Admissible  0 15 3 33  24.66  0.4633 0.323 0.640</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a><span class="co">#&gt; Admissible  0 13 3 35  23.71  0.5133 0.097 0.323</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a><span class="co">#&gt; Optimal     0 12 3 37  23.49  0.5404 0.000 0.097</span></span></code></pre></div>
<p>This output provides the key components (<span class="math inline">\(r_1\)</span>, <span class="math inline">\(r\)</span>, <span class="math inline">\(n_1\)</span>, and <span class="math inline">\(n\)</span>) as well as <span class="math inline">\(EN(p_0)\)</span> and <span class="math inline">\(PET(p_0)\)</span> for the selected optimal and minimax designs (shown in the first and second rows, respectively).</p>
<p>As expected, the optimal design has a smaller expected sample size (<span class="math inline">\(EN(p_0)\)</span>; about 23 vs. 26), whereas the minimax design has a smaller maximum sample size (<span class="math inline">\(n\)</span>; 32 vs. 37).</p>
<p>We can also visualize these results. Using the base <code>plot()</code>, plot the trial object.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Plot</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="kw">plot</span>(trial)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This output provides a visual representation of the maximum number of patients (<span class="math inline">\(n\)</span>) and expected sample size (<span class="math inline">\(EN(p_0)\)</span>) under various scenarios. O represents the optimal design, and M represents the minimax design.</p>
<p>The admissible design can be obtained by applying the <code>twostage.admissible()</code> function to the trial object.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co"># Obtain admissible design</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">twostage.admissible</span>(trial)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="co">#&gt;            r1 n1 r  n   EN(p0)   PET(p0)   qLo   qHi</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co">#&gt; Minimax     0 18 3 32 26.43900 0.3972143 0.640 1.000</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="co">#&gt; Admissible  0 15 3 33 24.66076 0.4632912 0.323 0.640</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="co">#&gt; Admissible  0 13 3 35 23.70647 0.5133421 0.097 0.323</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="co">#&gt; Optimal     0 12 3 37 23.49100 0.5403601 0.000 0.097</span></span></code></pre></div>
<p>This output includes the admissible design as well as the optimal and minimax designs. In addition to the design components seen earlier, columns <code>qLo</code> and <code>qHi</code> give the range of probability values for which the particular design is admissible.</p>
<p>For this particular trial, Tchekmedyian et al. opted for the minimax design. Thus, 18 patients were enrolled in stage 1 (<span class="math inline">\(n_1 = 18\)</span>). If no responses were observed (<span class="math inline">\(\leq 0\)</span> reduces to <span class="math inline">\(= 0\)</span> since the number of responses cannot be negative), then early termination would occur. Otherwise, if at least one response was observed, then 14 patients would be enrolled in stage 2 (<span class="math inline">\(n_2 = n - n_1 = 32 - 18 = 14\)</span>). At the end of stage 2, if at least 4 responses had been observed in total, then the treatment would be recommended; if 3 or fewer responses had been observed in total, then the treatment would not be recommended (<span class="math inline">\(r = 3\)</span>).</p>
<p>Ultimately, Tchekmedyian et al. observed four responses among the 18 patients enrolled in stage 1 and thus proceeded to stage 2, in which an additional 14 patients were enrolled. One response was observed among the stage 2 patients. Thus, at the end of the trial, 5 responses had been observed in total, and lenvatinib was recommended for further development in patients with progressive, recurrent or metastatic adenoid cystic carcinoma.</p>
</div>
<div id="cases-where-the-admissible-design-is-a-logical-choice" class="section level3">
<h3>Cases Where the Admissible Design Is a Logical Choice</h3>
<p>As described above, the optimal design minimizes the expected sample size, the minimax design minimizes the maximum sample size, and the admissible design represents a compromise between the two. Sometimes, the admissible design has only a slightly higher expected sample size than the optimal design and only a slightly higher maximum sample size than the minimax design. In these cases, the admissible design is a logical choice because it achieves the benefits of the both designs with only negligible impacts on the two metrics.</p>
<p>To illustrate this, we can consider a hypothetical example where we specific the following design parameters and constraints:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): 25% overall response rate</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): 45% overall response rate</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): 5% type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): 10% type II error threshold</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Specify the parameters and constraints</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>trial =<span class="st"> </span><span class="kw">ph2simon</span>(<span class="fl">0.25</span>, <span class="fl">0.45</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co"># Obtain admissible design</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="kw">twostage.admissible</span>(trial)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="co">#&gt;            r1 n1  r  n   EN(p0)   PET(p0)   qLo   qHi</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="co">#&gt; Minimax     6 26 17 49 37.14596 0.5153932 0.782 1.000</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="co">#&gt; Admissible  7 26 17 50 33.55630 0.6851542 0.129 0.782</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co">#&gt; Optimal     6 22 19 57 32.52206 0.6993697 0.000 0.129</span></span></code></pre></div>
<p>As we can see, the admissible design has an expected sample size that is nearly the same as the optimal design’s (34 vs. 33) and a maximum sample size that is nearly the same as the minimax design’s (50 vs. 49). It is logical to accept one more patient on whichever metric is of primary interest to obtain a design that performs well across both metrics.</p>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/2702835/">Simon R. (1989). Optimal Two-Stage Designs for Phase II Clinical Trials. Controlled Clinical Trials 10, 1-10.</a></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/11514038/">Jung SH, Carey M and Kim KM. (2001). Graphical Search for Two-Stage Designs for Phase II Clinical Trials. Controlled Clinical Trials 22, 367-372.</a></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/14755389/">Jung SH, Lee T, Kim K, and George, SL. (2004). Admissible two-stage designs for phase II cancer clinical trials. Statistics in medicine 23(4), 561-569.</a></p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/30939095/">Tchekmedyian V, Sherman EJ, Dunn L, et al. (2019) Phase II Study of Lenvatinib in Patients With Progressive, Recurrent or Metastatic Adenoid Cystic Carcinoma. J Clin Oncol. 37(18):1529-1537.</a></p>
</div>
</div>
<div id="single-stage" class="section level2">
<h2>Single-Stage</h2>
<p>A single-stage design may be used instead of a two-stage design when an endpoint requires too much time to evaluate or when early stopping is less of a priority.</p>
<p>The trial enrolls <span class="math inline">\(n\)</span> patients. After all patients have completed the study, if <span class="math inline">\(\leq r\)</span> responses have been observed in total, then the treatment is not recommended; if <span class="math inline">\(&gt;r\)</span> responses have been observed in total, then the treatment is recommended.</p>
<p>When designing a single-stage trial, the key objective is to select appropriate values of <span class="math inline">\(n\)</span> (sample size) and <span class="math inline">\(r\)</span> (response threshold at the end of the study). The response rate considered “unacceptable” (at which point a treatment would not be recommended) and the response rate considered “desirable” must be specified, and the values of <span class="math inline">\(r\)</span> and <span class="math inline">\(n\)</span> must be selected such that the desired error rate constraints are satisfied.</p>
<div id="design-parameters-and-constraints-1" class="section level3">
<h3>Design Parameters and Constraints</h3>
<p>In order to determine final design components, the following parameters and constraints must be specified:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): Treatment response rate considered unacceptable</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): Treatment response rate considered desirable</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): Type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): Type II error threshold</p></li>
</ul>
<p>The final design components depend on the response rates considered “unacceptable” (<span class="math inline">\(p_0\)</span>) and “desirable” (<span class="math inline">\(p_1\)</span>) and must satisfy the desired error rate constraints (<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>) for testing the following hypotheses:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true treatment response rate is less than or equal to some unacceptable level (<span class="math inline">\(p \leq p_0\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true treatment response rate is greater than or equal to some desirable level (<span class="math inline">\(p \geq p_1\)</span>)</p></li>
</ul>
</div>
<div id="example" class="section level3">
<h3>Example</h3>
<p>For this example, we will be looking at a phase II trial that assessed the efficacy of everolimus in patients with thymoma and thymic carcinoma previously treated with cisplatin-based chemotherapy (Zucali et al., 2018). Patients received everolimus 10 mg/day. Treatment was continued until disease progression, death, unacceptable toxicity, or study discontinuation for any other reason. Treatment response was specifically defined as disease control: achievement of either partial response, complete response, or stable disease, as defined by Response Evaluation Criteria in Solid Tumors (RECIST) version 1.1.</p>
<p>The trial employed a single-stage design. A disease control rate of 40% was considered unacceptable, and a disease control rate of 60% was considered desirable. The type I error threshold used was 10%. The target power used was 90%, equivalent to a 10% type II error threshold.</p>
<p>Summarizing the design parameters and constraints from above, we have:</p>
<ul>
<li><p><span class="math inline">\(p_0\)</span> (<code>pu</code>): 40% disease control rate</p></li>
<li><p><span class="math inline">\(p_1\)</span> (<code>pa</code>): 60% disease control rate</p></li>
<li><p><span class="math inline">\(\alpha\)</span> (<code>ep1</code>): 10% type I error threshold</p></li>
<li><p><span class="math inline">\(\beta\)</span> (<code>ep2</code>): 10% type II error threshold</p></li>
</ul>
<p>Thus, the hypotheses used for testing are:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>: The true disease control rate is less than or equal to 40% (<span class="math inline">\(p \leq 0.4\)</span>)</p></li>
<li><p><span class="math inline">\(H_1\)</span>: The true disease control rate is greater than or equal to 60% (<span class="math inline">\(p \geq 0.6%\)</span>)</p></li>
</ul>
<p>Using <code>ph2single()</code>, specify the parameters and print the resulting object.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Specify the parameters and constraints &amp; print</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">ph2single</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="co">#&gt;    n  r Type I error Type II error</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="co">#&gt; 1 41 20   0.09651722    0.09651722</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="co">#&gt; 2 43 21   0.09132412    0.09132412</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="co">#&gt; 3 45 22   0.08645205    0.08645205</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="co">#&gt; 4 47 23   0.08187654    0.08187654</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a><span class="co">#&gt; 5 49 24   0.07757556    0.07757556</span></span></code></pre></div>
<p>This output provides the key components (<span class="math inline">\(n\)</span> and <span class="math inline">\(r\)</span>) for applicable designs as well as the type I and type II error rates corresponding to each of these designs.</p>
<p>Zucali et al. chose the first option listed, the design that enrolls the smallest number of patients (<span class="math inline">\(n = 41\)</span>) that still satisfies the error rate constraints. The treatment would be recommended if at least 21 of the first 41 evaluable patients achieved disease control (<span class="math inline">\(r = 20\)</span>). Ultimately, greater than 21 of these patients achieved disease control, and everolimus was recommended for further development in patients with thymoma and thymic carcinoma previously treated with cisplatin-based chemotherapy.</p>
</div>
<div id="references-1" class="section level3">
<h3>References</h3>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/29240542/">Zucali PA, De Pas T, Palmieri G, et al. (2018). Phase II Study of Everolimus in Patients With Thymoma and Thymic Carcinoma Previously Treated With Cisplatin-Based Chemotherapy. J Clin Oncol. 36(4):342-349.</a></p>
</div>
</div>
</div>
<div id="constructing-stopping-rules" class="section level1">
<h1>Constructing Stopping Rules</h1>
<p>Stopping rules in clinical trials are a useful tool for risk management and can help ensure the protection of participants. Patient outcomes are monitored as the trial progresses, and the trial is terminated if certain conditions are met (eg, if the toxicity rate is too high). Stopping rules define the specific conditions under which the trial should be terminated.</p>
<p>General types of stopping rules include:</p>
<ul>
<li><p><strong>Stopping for toxicity:</strong> The trial is stopped if the toxicity rate is too high. Terminating the trial minimizes the number of patients exposed to a treatment that is likely too toxic relative to its potential benefits.</p></li>
<li><p><strong>Stopping for futility:</strong> The trial is stopped if the response rate is too low. Terminating the trial minimizes the number of patients exposed to a potentially ineffective treatment.</p></li>
</ul>
<p>A trial may contain one or multiple types of stopping rules. The choice of stopping rules is highly dependent on factors such as disease area, the clinical outcomes of interest, stage of development, and characteristics of the treatment itself.</p>
<p>There are various statistical methods available to construct stopping rules.</p>
<p>This section describes the specific types of stopping rules that can be constructed using {clinfun}.</p>
<div id="stopping-for-toxicity-for-phase-ii-and-phase-iii-designs" class="section level2">
<h2>Stopping for Toxicity (For Phase II and Phase III Designs)</h2>
<p><code>toxbdry()</code> computes a stopping rule for toxicity that can be implemented in phase II and III designs. For example, a stopping rule generated by this function could be layered on top of a design generated by <code>ph2simon()</code> or <code>ph2single()</code>.</p>
</div>
<div id="stopping-for-futility-for-phase-ii-single-stage-designs" class="section level2">
<h2>Stopping for Futility (For Phase II Single-Stage Designs)</h2>
<p>A Simon’s two-stage design effectively has a stopping rule for futility built in (evaluated at the end of stage 1). However, there are scenarios in which a single-stage design with an added stopping rule for futility is chosen instead of a two-stage design. When the response outcome takes a long time to assess (eg, complete response rate at 30 months) and accrual for a trial is slow, assessing efficacy on a continual basis is preferable to waiting for the completion of stage 1.</p>
<p><code>futilbdry()</code> computes a stopping rule for futility that is specifically intended to be implemented in phase II single-stage designs. Thus, a stopping rule generated by this function would be layered on top of a design generated by <code>ph2single()</code>.</p>
</div>
</div>
<div id="calculating-sample-size-effect-size-and-power" class="section level1">
<h1>Calculating Sample Size, Effect Size, and Power</h1>
<div id="fishers-exact-test" class="section level2">
<h2>Fisher’s Exact Test</h2>
<p>{clinfun} offers a set of functions to determine sample sizes, effect sizes, and power based on Fisher’s exact tests. Below is a table summarizing the functions based on Fisher’s exact test.</p>
<table>
<colgroup>
<col width="22%"></col>
<col width="77%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>fe.ssize()</code></td>
<td>Returns a 2x3 matrix with Casagrande, Pike, Smith (CPS) and Fisher’s exact sample sizes with power.</td>
</tr>
<tr class="even">
<td><code>fe.mdor()</code></td>
<td>Returns a 3x2 matrix with Schlesselman, CPS and Fisher’s exact minimum detectable odds ratios and the corresponding power.</td>
</tr>
<tr class="odd">
<td><code>fe.power()</code></td>
<td>Returns a Kx2 matrix with probabilities (p2) and exact power.</td>
</tr>
<tr class="even">
<td><code>CPS.ssize()</code></td>
<td>Returns CPS sample size, which is a very close to the exact. Use this for small differences p2-p1 (hence large sample sizes) to get the result instantaneously.</td>
</tr>
<tr class="odd">
<td><code>mdrr()</code></td>
<td>Computes the minimum detectable P(resp given marker+) and P(resp given marker-) configurations when total sample size (n), P(response) (presp) and proportion of subjects who are marker positive (cprob) are specified.</td>
</tr>
<tr class="even">
<td><code>or2pcase()</code></td>
<td>Gives the probability of disease among the cases for a given probability of disease in controls (pcontrol) and odds ratio (OR).</td>
</tr>
</tbody>
</table>
<div id="example-1" class="section level3">
<h3>Example</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">fe.ssize</span>(<span class="dt">p1 =</span> <span class="fl">0.2</span>, <span class="dt">p2 =</span> <span class="fl">0.3</span>, <span class="dt">power =</span> <span class="fl">0.8</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="co">#&gt;              Group 1 Group 2 Exact Power</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="co">#&gt; CPS              313     313   0.8018729</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="co">#&gt; Fisher Exact     311     311   0.8004486</span></span></code></pre></div>
<p><em>CAUTION:</em> As we can see below, when we use base R <code>power.prop.test()</code>, we obtain an incorrect result due to normal approximation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">power.prop.test</span>(<span class="dt">p1 =</span> <span class="fl">0.2</span>, <span class="dt">p2 =</span> <span class="fl">0.3</span>, <span class="dt">power =</span> <span class="fl">0.8</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="co">#&gt;      Two-sample comparison of proportions power calculation </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="co">#&gt;               n = 293.1513</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a><span class="co">#&gt;              p1 = 0.2</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a><span class="co">#&gt;              p2 = 0.3</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a><span class="co">#&gt;       sig.level = 0.05</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a><span class="co">#&gt;           power = 0.8</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a><span class="co">#&gt;     alternative = two.sided</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: n is number in *each* group</span></span></code></pre></div>
</div>
<div id="references-2" class="section level3">
<h3>References</h3>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/719125/">Casagrande JT, Pike MC, Smith PG. (1978). An improved approximate formula for calculating sample sizes for comparing two binomial distributions. Biometrics 34, 483-486.</a></p>
<p>Fleiss, JL. (1981). Statistical Methods for Rates and Proportions.</p>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/3812441/">Schlesselman JJ. (1987) Re: Smallest detectable relative risk with multiple controls per case. Am J Epidemiol 125(2), 348.</a></p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
